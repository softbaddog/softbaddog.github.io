(window.webpackJsonp=window.webpackJsonp||[]).push([[148],{554:function(t,e,s){t.exports=s.p+"assets/img/bh1750-map.632c283d.png"},555:function(t,e,s){t.exports=s.p+"assets/img/bh1750-datasheet.3742aadd.png"},556:function(t,e,s){t.exports=s.p+"assets/img/bh1750-drv.2e6bbc18.png"},557:function(t,e,s){t.exports=s.p+"assets/img/bh1750-gpio.c89b5545.png"},558:function(t,e,s){t.exports=s.p+"assets/img/bh1750-read.a4e59536.png"},559:function(t,e,s){t.exports=s.p+"assets/img/nb-iot-demo-source.8ac9af73.png"},560:function(t,e,s){t.exports=s.p+"assets/img/nb-iot-demo-head.9c0d3a3d.png"},561:function(t,e,s){t.exports=s.p+"assets/img/nb-iot-demo-convert.ebd74659.png"},562:function(t,e,s){t.exports=s.p+"assets/img/nb-iot-demo-send.04148829.png"},563:function(t,e,s){t.exports=s.p+"assets/img/nb-iot-demo-send2.2620e3e1.png"},564:function(t,e,s){t.exports=s.p+"assets/img/nb-iot-demo-send3.06331688.png"},565:function(t,e,s){t.exports=s.p+"assets/img/nb-iot-demo-ioctl.2ca406e2.png"},566:function(t,e,s){t.exports=s.p+"assets/img/nb-iot-demo-light.837ee963.png"},567:function(t,e,s){t.exports=s.p+"assets/img/nb-iot-demo-entry.ed192918.png"},568:function(t,e,s){t.exports=s.p+"assets/img/nb-iot-demo-board.8f318413.png"},569:function(t,e,s){t.exports=s.p+"assets/img/qcom-serials-tool.6f022f7f.png"},570:function(t,e,s){t.exports=s.p+"assets/img/qcom-baudrate.8ab609ef.png"},571:function(t,e,s){t.exports=s.p+"assets/img/oc-reg-device.3c586ce8.png"},572:function(t,e,s){t.exports=s.p+"assets/img/oc-load-profile.4c5e189a.png"},573:function(t,e,s){t.exports=s.p+"assets/img/oc-write-deviceinfo.6c6b7b05.png"},574:function(t,e,s){t.exports=s.p+"assets/img/oc-device-history.4a9cd7e0.png"},575:function(t,e,s){t.exports=s.p+"assets/img/oc-data-history.690fc802.png"},576:function(t,e,s){t.exports=s.p+"assets/img/qcom-report-data.496c869f.png"},577:function(t,e,s){t.exports=s.p+"assets/img/oc-blank-data.d9376ddf.png"},578:function(t,e,s){t.exports=s.p+"assets/img/oc-cmd-send.f40e1443.png"},579:function(t,e,s){t.exports=s.p+"assets/img/qcom-recv-cmd.ee4b130a.png"},580:function(t,e,s){t.exports=s.p+"assets/img/oc-show-data.57d5bbce.png"},581:function(t,e,s){t.exports=s.p+"assets/img/board-connect.9d9a9df6.png"},582:function(t,e,s){t.exports=s.p+"assets/img/board-debug.320ffb01.png"},583:function(t,e,s){t.exports=s.p+"assets/img/nb-iot-demo-project.62f8da05.png"},608:function(t,e,s){"use strict";s.r(e);var a=[function(){var t=this.$createElement,e=this._self._c||t;return e("h1",{attrs:{id:"智慧路灯实验"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#智慧路灯实验","aria-hidden":"true"}},[this._v("#")]),this._v(" 智慧路灯实验")])},function(){var t=this.$createElement,e=this._self._c||t;return e("h2",{attrs:{id:"实验背景"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#实验背景","aria-hidden":"true"}},[this._v("#")]),this._v(" 实验背景")])},function(){var t=this.$createElement,e=this._self._c||t;return e("h2",{attrs:{id:"实验准备"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#实验准备","aria-hidden":"true"}},[this._v("#")]),this._v(" 实验准备")])},function(){var t=this.$createElement,e=this._self._c||t;return e("thead",[e("tr",[e("th",[this._v("名称")]),this._v(" "),e("th",{staticStyle:{"text-align":"center"}},[this._v("数量")]),this._v(" "),e("th",[this._v("备注")])])])},function(){var t=this.$createElement,e=this._self._c||t;return e("tr",[e("td",[this._v("EVB_M1开发板")]),this._v(" "),e("td",{staticStyle:{"text-align":"center"}},[this._v("1")]),this._v(" "),e("td")])},function(){var t=this.$createElement,e=this._self._c||t;return e("tr",[e("td",[this._v("光照强度传感器扩展板")]),this._v(" "),e("td",{staticStyle:{"text-align":"center"}},[this._v("1")]),this._v(" "),e("td")])},function(){var t=this.$createElement,e=this._self._c||t;return e("tr",[e("td",[this._v("MDK(keil 5)软件")]),this._v(" "),e("td",{staticStyle:{"text-align":"center"}},[this._v("1")]),this._v(" "),e("td",[this._v("自行导入License")])])},function(){var t=this.$createElement,e=this._self._c||t;return e("tr",[e("td",[this._v("安卓手机")]),this._v(" "),e("td",{staticStyle:{"text-align":"center"}},[this._v("1")]),this._v(" "),e("td")])},function(){var t=this.$createElement,e=this._self._c||t;return e("tr",[e("td",[this._v("手机APK")]),this._v(" "),e("td",{staticStyle:{"text-align":"center"}},[this._v("1")]),this._v(" "),e("td")])},function(){var t=this.$createElement,e=this._self._c||t;return e("h2",{attrs:{id:"熟悉liteos工程文件"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#熟悉liteos工程文件","aria-hidden":"true"}},[this._v("#")]),this._v(" 熟悉LiteOS工程文件")])},function(){var t=this.$createElement,e=this._self._c||t;return e("p",[this._v("LiteOS入口在工程对应的 "),e("code",[this._v("main.c")]),this._v(" 中，基本流程如下：")])},function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"language-c extra-class"},[s("pre",{pre:!0,attrs:{class:"language-c"}},[s("code",[s("span",{attrs:{class:"token keyword"}},[t._v("int")]),t._v(" "),s("span",{attrs:{class:"token function"}},[t._v("main")]),s("span",{attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{attrs:{class:"token keyword"}},[t._v("void")]),s("span",{attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),s("span",{attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  UINT32 uwRet "),s("span",{attrs:{class:"token operator"}},[t._v("=")]),t._v(" LOS_OK"),s("span",{attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n  "),s("span",{attrs:{class:"token function"}},[t._v("HardWare_Init")]),s("span",{attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n  uwRet "),s("span",{attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{attrs:{class:"token function"}},[t._v("LOS_KernelInit")]),s("span",{attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n  "),s("span",{attrs:{class:"token keyword"}},[t._v("if")]),t._v(" "),s("span",{attrs:{class:"token punctuation"}},[t._v("(")]),t._v("uwRet "),s("span",{attrs:{class:"token operator"}},[t._v("!=")]),t._v(" LOS_OK"),s("span",{attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n  "),s("span",{attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n      "),s("span",{attrs:{class:"token keyword"}},[t._v("return")]),t._v(" LOS_NOK"),s("span",{attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n  "),s("span",{attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n\n  "),s("span",{attrs:{class:"token function"}},[t._v("LOS_Inspect_Entry")]),s("span",{attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n  "),s("span",{attrs:{class:"token function"}},[t._v("LOS_Start")]),s("span",{attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),s("span",{attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])])])},function(){var t=this.$createElement,e=this._self._c||t;return e("ol",[e("li",[this._v("首先进行硬件初始化 HardWare_Init();")]),this._v(" "),e("li",[this._v("初始化LiteOS内核 LOS_KernelInit();")]),this._v(" "),e("li",[this._v("初始化内核例程 LOS_Inspect_Entry();")]),this._v(" "),e("li",[this._v("最后调用LOS_Start();开始task调度，LiteOS开始正常工作")])])},function(){var t=this.$createElement,e=this._self._c||t;return e("h2",{attrs:{id:"创建liteos系统任务"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#创建liteos系统任务","aria-hidden":"true"}},[this._v("#")]),this._v(" 创建LiteOS系统任务")])},function(){var t=this.$createElement,e=this._self._c||t;return e("h2",{attrs:{id:"移植传感器程序"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#移植传感器程序","aria-hidden":"true"}},[this._v("#")]),this._v(" 移植传感器程序")])},function(){var t=this.$createElement,e=this._self._c||t;return e("p",[e("img",{attrs:{src:s(554),alt:""}})])},function(){var t=this.$createElement,e=this._self._c||t;return e("p",[e("img",{attrs:{src:s(555),alt:""}})])},function(){var t=this.$createElement,e=this._self._c||t;return e("p",[e("img",{attrs:{src:s(556),alt:""}})])},function(){var t=this.$createElement,e=this._self._c||t;return e("p",[e("img",{attrs:{src:s(557),alt:""}})])},function(){var t=this.$createElement,e=this._self._c||t;return e("p",[e("img",{attrs:{src:s(558),alt:""}})])},function(){var t=this.$createElement,e=this._self._c||t;return e("h2",{attrs:{id:"编写传感器数据采集任务回调函数"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#编写传感器数据采集任务回调函数","aria-hidden":"true"}},[this._v("#")]),this._v(" 编写传感器数据采集任务回调函数")])},function(){var t=this.$createElement,e=this._self._c||t;return e("p",[e("img",{attrs:{src:s(559),alt:""}})])},function(){var t=this.$createElement,e=this._self._c||t;return e("p",[e("img",{attrs:{src:s(560),alt:""}})])},function(){var t=this.$createElement,e=this._self._c||t;return e("p",[e("img",{attrs:{src:s(561),alt:""}})])},function(){var t=this.$createElement,e=this._self._c||t;return e("h2",{attrs:{id:"编写数据发送任务回调函数"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#编写数据发送任务回调函数","aria-hidden":"true"}},[this._v("#")]),this._v(" 编写数据发送任务回调函数")])},function(){var t=this.$createElement,e=this._self._c||t;return e("p",[e("img",{attrs:{src:s(562),alt:""}})])},function(){var t=this.$createElement,e=this._self._c||t;return e("p",[e("img",{attrs:{src:s(563),alt:""}})])},function(){var t=this.$createElement,e=this._self._c||t;return e("p",[e("img",{attrs:{src:s(564),alt:""}})])},function(){var t=this.$createElement,e=this._self._c||t;return e("h2",{attrs:{id:"编写urc数据消息回调函数处理程序"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#编写urc数据消息回调函数处理程序","aria-hidden":"true"}},[this._v("#")]),this._v(" 编写URC数据消息回调函数处理程序")])},function(){var t=this.$createElement,e=this._self._c||t;return e("p",[e("img",{attrs:{src:s(565),alt:""}})])},function(){var t=this.$createElement,e=this._self._c||t;return e("p",[e("img",{attrs:{src:s(566),alt:""}})])},function(){var t=this.$createElement,e=this._self._c||t;return e("h2",{attrs:{id:"编写初始化nb-iot模块函数"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#编写初始化nb-iot模块函数","aria-hidden":"true"}},[this._v("#")]),this._v(" 编写初始化NB-IoT模块函数")])},function(){var t=this.$createElement,e=this._self._c||t;return e("p",[e("img",{attrs:{src:s(567),alt:""}})])},function(){var t=this.$createElement,e=this._self._c||t;return e("h2",{attrs:{id:"制作profile"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#制作profile","aria-hidden":"true"}},[this._v("#")]),this._v(" 制作Profile")])},function(){var t=this.$createElement,e=this._self._c||t;return e("h2",{attrs:{id:"制作编解码插件"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#制作编解码插件","aria-hidden":"true"}},[this._v("#")]),this._v(" 制作编解码插件")])},function(){var t=this.$createElement,e=this._self._c||t;return e("h2",{attrs:{id:"nb-iot模块对接平台"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#nb-iot模块对接平台","aria-hidden":"true"}},[this._v("#")]),this._v(" NB-IoT模块对接平台")])},function(){var t=this.$createElement,e=this._self._c||t;return e("h3",{attrs:{id:"_1-nb-iot-at指令解析"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_1-nb-iot-at指令解析","aria-hidden":"true"}},[this._v("#")]),this._v(" 1. NB-IoT:AT指令解析")])},function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"tip custom-block"},[e("p",{staticClass:"custom-block-title"},[this._v("注意")]),this._v(" "),e("p",[this._v("AT指令详细内容，请参阅NB模块指令集手册。")])])},function(){var t=this.$createElement,e=this._self._c||t;return e("h3",{attrs:{id:"_2-动手操作nb-iot"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_2-动手操作nb-iot","aria-hidden":"true"}},[this._v("#")]),this._v(" 2. 动手操作NB-IoT")])},function(){var t=this.$createElement,e=this._self._c||t;return e("ul",[e("li",[this._v("这部分内容是：通过电脑串口调试软件，手动发AT指令，直接发给NB-IoT模块。NB模块返回的信息，直接到电脑串口调试软件。一步一步动手操作，实现连接OceanConnect平台。采用的通讯协议是CoAP协议。")])])},function(){var t=this.$createElement,e=this._self._c||t;return e("p",[e("img",{attrs:{src:s(568),alt:""}})])},function(){var t=this.$createElement,e=this._self._c||t;return e("h3",{attrs:{id:"_3-开发板硬件接线"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_3-开发板硬件接线","aria-hidden":"true"}},[this._v("#")]),this._v(" 3. 开发板硬件接线")])},function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"tip custom-block"},[e("p",{staticClass:"custom-block-title"},[this._v("注意")]),this._v(" "),e("p",[this._v("P12跳线帽和烧写器的接线方式")])])},function(){var t=this.$createElement,e=this._self._c||t;return e("h3",{attrs:{id:"_4-nb-iot与串口调试助手通信"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_4-nb-iot与串口调试助手通信","aria-hidden":"true"}},[this._v("#")]),this._v(" 4. NB-IoT与串口调试助手通信")])},function(){var t=this.$createElement,e=this._self._c||t;return e("p",[e("img",{attrs:{src:s(569),alt:""}})])},function(){var t=this.$createElement,e=this._self._c||t;return e("ul",[e("li",[this._v("波特率：9600。串口号根据电脑实际情况选择,并点击Open Port")])])},function(){var t=this.$createElement,e=this._self._c||t;return e("p",[e("img",{attrs:{src:s(570),alt:""}})])},function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"language- extra-class"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[this._v("0???\nREBOOT_CAUSE_APPLICATION_AT\nNeul \nOK\n")])])])},function(){var t=this.$createElement,e=this._self._c||t;return e("ul",[e("li",[this._v("命令2 发：AT+CGMR 【注意】当前模块最高版本为657SP5，日后版本或许还会有升级，若您此时模块版本低于657SP5，请参考模块升级教程进行升级。")])])},function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"language- extra-class"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[this._v("SECURITY,V100R100C10B657SP5\n\nPROTOCOL,V100R100C10B657SP5\n\nAPPLICATION,V100R100C10B657SP5\n\nSEC_UPDATER,V100R100C10B657SP5\n\nAPP_UPDATER,V100R100C10B657SP5\n\nRADIO,BC95HB-02-STD_850\n\nOK\n")])])])},function(){var t=this.$createElement,e=this._self._c||t;return e("ul",[e("li",[this._v("命令3 发：AT+NBAND?")])])},function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"language- extra-class"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[this._v("+NBAND:5\n\nOK\n")])])])},function(){var t=this.$createElement,e=this._self._c||t;return e("ul",[e("li",[this._v("命令4 发：AT+CGSN=1 【注意】657SP2版本以上的模块，可以直接通过此命令，读取IMEI号。")])])},function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"language- extra-class"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[this._v("+CGSN:863703330633304\n\nOK\n")])])])},function(){var t=this.$createElement,e=this._self._c||t;return e("ul",[e("li",[this._v("命令5 发：AT+NCDP=218.4.33.72,5683 【注意】若是其他华为云平台，请修改为相应IP和端口号。")])])},function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"language- extra-class"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[this._v("OK\n")])])])},function(){var t=this.$createElement,e=this._self._c||t;return e("ul",[e("li",[this._v("命令6 发：AT+NCDP?")])])},function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"language- extra-class"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[this._v("+NCDP:218.4.33.72,5683\n\nOK\n")])])])},function(){var t=this.$createElement,e=this._self._c||t;return e("ul",[e("li",[this._v("命令7 发：AT+CEREG=1")])])},function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"language- extra-class"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[this._v("OK\n")])])])},function(){var t=this.$createElement,e=this._self._c||t;return e("ul",[e("li",[this._v("命令8 发：AT+CMEE=1 【注意】此处打开详细错误代码功能。不开启的话，若出现问题则统一返回ERROR。")])])},function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"language- extra-class"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[this._v("OK\n")])])])},function(){var t=this.$createElement,e=this._self._c||t;return e("ul",[e("li",[this._v("命令9 发：AT+NSMI=1")])])},function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"language- extra-class"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[this._v("OK\n")])])])},function(){var t=this.$createElement,e=this._self._c||t;return e("ul",[e("li",[this._v("命令10 发：AT+NNMI=1")])])},function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"language- extra-class"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[this._v("OK\n")])])])},function(){var t=this.$createElement,e=this._self._c||t;return e("ul",[e("li",[this._v("命令11 发：AT+CIMI")])])},function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"language- extra-class"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[this._v("460111176313522\n\nOK\n")])])])},function(){var t=this.$createElement,e=this._self._c||t;return e("ul",[e("li",[this._v("命令12 发：AT+CSQ")])])},function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"language- extra-class"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[this._v("+CSQ:25,99\n\nOK\n")])])])},function(){var t=this.$createElement,e=this._self._c||t;return e("ul",[e("li",[this._v("命令13 发：AT+NUESTATS")])])},function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"language- extra-class"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[this._v("Signal power:-718\nTotal power:-625\nTX power:-30\nTX time:652\nRX time:22771\nCell ID:67208020\nECL:1\nSNR:38\nEARFCN:2507\nPCI:301\nRSRQ:-125\n\nOK\n")])])])},function(){var t=this.$createElement,e=this._self._c||t;return e("ul",[e("li",[this._v("命令14 发：AT+CGATT?")])])},function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"language- extra-class"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[this._v("+CGATT:1\n\nOK\n")])])])},function(){var t=this.$createElement,e=this._self._c||t;return e("ul",[e("li",[this._v("命令15 发：AT+NMSTATUS? 【注意】此命令用于测试NB模块与IoT平台的连接情况。第一次通过AT+NMGS命令发送上报数据时，若返回513错误 “+CME ERROR: 513”，则需要查询AT+NMSTATUS?，直到模块返回+NMSTATUS:MO_DATA_ENABLED，表示NB模块与IoT平台已经连接。")])])},function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"language- extra-class"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[this._v("+NMSTATUS:MO_DATA_ENABLED\n\nOK\n")])])])},function(){var t=this.$createElement,e=this._self._c||t;return e("ul",[e("li",[this._v("命令16 发：AT+NMGS=5,2020373839 【注意】上报数据：789")])])},function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"language- extra-class"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[this._v("OK\n\n+NSMI:SENT\n")])])])},function(){var t=this.$createElement,e=this._self._c||t;return e("ul",[e("li",[e("p",[this._v("命令17 发：AT+NMGR【注意】此命令用于读取下发的命令")])]),this._v(" "),e("li",[e("p",[this._v("命令18 发：AT+NQMGS")])])])},function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"language- extra-class"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[this._v("PENDING=0,SENT=6,ERROR=0\n\nOK\n")])])])},function(){var t=this.$createElement,e=this._self._c||t;return e("ul",[e("li",[this._v("命令19 发：AT+NQMGR")])])},function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"language- extra-class"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[this._v("BUFFERED=0,RECEIVED=0,DROPPED=0\n\nOK\n")])])])},function(){var t=this.$createElement,e=this._self._c||t;return e("h3",{attrs:{id:"_5-注册nb-iot设备"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_5-注册nb-iot设备","aria-hidden":"true"}},[this._v("#")]),this._v(" 5. 注册NB-IoT设备")])},function(){var t=this.$createElement,e=this._self._c||t;return e("ul",[e("li",[this._v("点击右上角“注册设备”。准备注册一个真实的NB-IoT设备。")])])},function(){var t=this.$createElement,e=this._self._c||t;return e("p",[e("img",{attrs:{src:s(571),alt:""}})])},function(){var t=this.$createElement,e=this._self._c||t;return e("ul",[e("li",[this._v("选择对应的profile")])])},function(){var t=this.$createElement,e=this._self._c||t;return e("p",[e("img",{attrs:{src:s(572),alt:""}})])},function(){var t=this.$createElement,e=this._self._c||t;return e("ul",[e("li",[this._v("填写设备信息")])])},function(){var t=this.$createElement,e=this._self._c||t;return e("p",[e("img",{attrs:{src:s(573),alt:""}})])},function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"tip custom-block"},[e("p",{staticClass:"custom-block-title"},[this._v("注意")]),this._v(" "),e("p",[this._v("此处设备标识码要填写NB-IoT模块的IMEI号。有2个方法获取IMEI号，可以从模块上直接看到，也可以通过AT+CGSN=1指令读出来。（推荐使用AT指令读取的方式）")])])},function(){var t=this.$createElement,e=this._self._c||t;return e("h3",{attrs:{id:"_6-nb-iot与oceanconnect云平台联合调试"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_6-nb-iot与oceanconnect云平台联合调试","aria-hidden":"true"}},[this._v("#")]),this._v(" 6. NB-IoT与OceanConnect云平台联合调试")])},function(){var t=this.$createElement,e=this._self._c||t;return e("ul",[e("li",[this._v("命令16 发： AT+NMGS=5,2020373839 【注意】上报数据：789。")])])},function(){var t=this.$createElement,e=this._self._c||t;return e("ul",[e("li",[this._v("此时可以在OceanConnect平台，查看真实NB设备，已经绑定。点击设备，进去查看历史数据。")])])},function(){var t=this.$createElement,e=this._self._c||t;return e("p",[e("img",{attrs:{src:s(574),alt:""}})])},function(){var t=this.$createElement,e=this._self._c||t;return e("p",[e("img",{attrs:{src:s(575),alt:""}})])},function(){var t=this.$createElement,e=this._self._c||t;return e("ul",[e("li",[this._v("此时在串口调试软件中，命令AT+NQMGS，命令AT+NQMGR 可以查看已发送消息统计、已接收消息统计")])])},function(){var t=this.$createElement,e=this._self._c||t;return e("p",[e("img",{attrs:{src:s(576),alt:""}})])},function(){var t=this.$createElement,e=this._self._c||t;return e("h3",{attrs:{id:"_7-oceanconnect平台下发命令到nb-iot模块"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_7-oceanconnect平台下发命令到nb-iot模块","aria-hidden":"true"}},[this._v("#")]),this._v(" 7. OceanConnect平台下发命令到NB-IoT模块")])},function(){var t=this.$createElement,e=this._self._c||t;return e("ul",[e("li",[e("p",[this._v("【注意】由于NB-IoT模块的PSM省电模式，OceanConnect平台不会立即下发命令，而是等待NB-IoT模块上发一条数据后，此时才会将缓存在云平台上的命令下发。所以，在测试IoT云平台下发命令功能时，每次下发命令前，需要先通过NB模块上发一条数据。具体操作是：通过串口调试软件，发送AT+NMGS=5,2020333435，此时在云平台点击命令下发。")])]),this._v(" "),e("li",[e("p",[this._v("在OceanConnect平台，点击设备，进去查看历史命令。由于此时还没有下发命令，所以此次数据为空白。")])])])},function(){var t=this.$createElement,e=this._self._c||t;return e("p",[e("img",{attrs:{src:s(577),alt:""}})])},function(){var t=this.$createElement,e=this._self._c||t;return e("ul",[e("li",[e("p",[this._v("回到设备列表。点击图标，进入下发命令界面")])]),this._v(" "),e("li",[e("p",[this._v("设置LED下发控制命令。【注意：在点发送之前，最好使用AT+NMGS=5,2020333435，先上报一条数据】。点击发送命令")])]),this._v(" "),e("li",[e("p",[this._v("IoT云平台下发1次命令，串口调试助手接收到1次数据。")])])])},function(){var t=this.$createElement,e=this._self._c||t;return e("p",[e("img",{attrs:{src:s(578),alt:""}})])},function(){var t=this.$createElement,e=this._self._c||t;return e("p",[e("img",{attrs:{src:s(579),alt:""}})])},function(){var t=this.$createElement,e=this._self._c||t;return e("p",[e("img",{attrs:{src:s(580),alt:""}})])},function(){var t=this.$createElement,e=this._self._c||t;return e("ul",[e("li",[this._v("至此，完成NB-IoT模块连接OceanConnect平台动手内容")])])},function(){var t=this.$createElement,e=this._self._c||t;return e("h2",{attrs:{id:"liteos调测"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#liteos调测","aria-hidden":"true"}},[this._v("#")]),this._v(" LiteOS调测")])},function(){var t=this.$createElement,e=this._self._c||t;return e("h3",{attrs:{id:"_1-开发板硬件连接"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_1-开发板硬件连接","aria-hidden":"true"}},[this._v("#")]),this._v(" 1. 开发板硬件连接")])},function(){var t=this.$createElement,e=this._self._c||t;return e("ul",[e("li",[this._v("确认图中几个位置是否连接正确。")])])},function(){var t=this.$createElement,e=this._self._c||t;return e("p",[e("img",{attrs:{src:s(581),alt:""}})])},function(){var t=this.$createElement,e=this._self._c||t;return e("p",[e("img",{attrs:{src:s(582),alt:""}})])},function(){var t=this.$createElement,e=this._self._c||t;return e("h3",{attrs:{id:"_2-打开mdk523项目"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_2-打开mdk523项目","aria-hidden":"true"}},[this._v("#")]),this._v(" 2. 打开MDK523项目")])},function(){var t=this.$createElement,e=this._self._c||t;return e("ul",[e("li",[this._v("进入targets\\STM32L431RxTx_IoTClub\\MDK-ARM，打开STM32L431RxTx.uvprojx")])])},function(){var t=this.$createElement,e=this._self._c||t;return e("p",[e("img",{attrs:{src:s(583),alt:""}})])},function(){var t=this.$createElement,e=this._self._c||t;return e("h3",{attrs:{id:"_3-下载运行"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_3-下载运行","aria-hidden":"true"}},[this._v("#")]),this._v(" 3. 下载运行")])},function(){var t=this.$createElement,e=this._self._c||t;return e("ul",[e("li",[this._v("配置环境")])])},function(){var t=this.$createElement,e=this._self._c||t;return e("h2",{attrs:{id:"体验手机app"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#体验手机app","aria-hidden":"true"}},[this._v("#")]),this._v(" 体验手机APP")])},function(){var t=this.$createElement,e=this._self._c||t;return e("h3",{attrs:{id:"_1-获取手机app"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_1-获取手机app","aria-hidden":"true"}},[this._v("#")]),this._v(" 1. 获取手机APP")])},function(){var t=this.$createElement,e=this._self._c||t;return e("ul",[e("li",[this._v("文件目录")])])},function(){var t=this.$createElement,e=this._self._c||t;return e("h3",{attrs:{id:"_2-安装app"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_2-安装app","aria-hidden":"true"}},[this._v("#")]),this._v(" 2. 安装APP")])},function(){var t=this.$createElement,e=this._self._c||t;return e("h3",{attrs:{id:"_3-登陆app"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_3-登陆app","aria-hidden":"true"}},[this._v("#")]),this._v(" 3. 登陆APP")])},function(){var t=this.$createElement,e=this._self._c||t;return e("h3",{attrs:{id:"_4-app实时显示数据"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_4-app实时显示数据","aria-hidden":"true"}},[this._v("#")]),this._v(" 4. APP实时显示数据")])}],n=s(0),r=Object(n.a)({},function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"content"},[t._m(0),t._v(" "),t._m(1),t._v(" "),s("p",[t._v("随着城市经济和规模的发展，各种类型的道路越来越长，机动车数量迅速增加，夜间交通流量也越来越大，道路照明质量直接影响交通安全和城市发展。如何提高道路照明质量、降低能耗、实现绿色照明已成为城市照明的关键问题。道路照明的首要任务是在节约公共能源的基础上，提供安全和舒适的照明亮度，达到减少交通事故，提升交通运输效率的目的。由于基础设施的条件所限，目前普遍缺少路灯级的通信链路，路灯控制方式一般只能对整条道路统一控制，无法测量和控制到每一盏灯。")]),t._v(" "),s("p",[t._v("NB-IoT智能路灯可实现单灯精确控制和维护，并根据季节、天气、场景变化灵活设置路灯开/关/亮度，节省电耗10-20%；使用NB-IoT智能路灯方案后，路灯运营方无需人工巡检，可远程检测并定位故障，并结合路灯运行历史开展生命周期管理，降低运维成本达50%。")]),t._v(" "),s("p",[t._v("NB-IoT智能路灯利用运营商网络，路灯即插即用，并通过“一跳”的方式将数据传到路灯管理云平台。由于使用运营商的网络，省去了后期的维护成本，网络的覆盖质量和优化也由电信运营商负责。")]),t._v(" "),s("p",[t._v("本实验将以NB-IoT智能路灯为场景，带大家快速了解NB-IoT智能路灯的原型开发，实现环境光强度的采集，及路灯单灯控制")]),t._v(" "),t._m(2),t._v(" "),s("table",[t._m(3),t._v(" "),s("tbody",[t._m(4),t._v(" "),t._m(5),t._v(" "),t._m(6),t._v(" "),s("tr",[s("td",[t._v("OceanConnect账号")]),t._v(" "),s("td",{staticStyle:{"text-align":"center"}},[t._v("1")]),t._v(" "),s("td",[s("a",{attrs:{href:"https://developer.huawei.com/ict/cn/remotelab/iot",target:"_blank",rel:"noopener noreferrer"}},[t._v("可远程实验室申请"),s("OutboundLink")],1)])]),t._v(" "),s("tr",[s("td",[t._v("LiteOS开源代码")]),t._v(" "),s("td",{staticStyle:{"text-align":"center"}},[t._v("1")]),t._v(" "),s("td",[s("a",{attrs:{href:"https://github.com/LiteOS/LiteOS",target:"_blank",rel:"noopener noreferrer"}},[t._v("GitHub地址"),s("OutboundLink")],1)])]),t._v(" "),t._m(7),t._v(" "),t._m(8)])]),t._v(" "),t._m(9),t._v(" "),s("p",[t._v("LiteOS代码入口")]),t._v(" "),t._m(10),t._v(" "),t._m(11),t._m(12),t._v(" "),s("p",[t._v("LiteOS的代码目录结构说明")]),t._v(" "),s("p",[t._v("关于代码树中各个目录存放的源代码的相关内容简介如下：")]),t._v(" "),t._m(13),t._v(" "),s("p",[t._v("传统任务创建方法")]),t._v(" "),t._m(14),t._v(" "),s("p",[t._v("此案例检测光照强度的传感器为BH1750")]),t._v(" "),s("p",[t._v("BH1750内部的框图如下：")]),t._v(" "),t._m(15),t._v(" "),s("p",[t._v("BH1750 主要由 PD（由光敏二极管组成）、集成运算放大器、模数转换器、光强计算部分及IIC通信接口等组成。\n光敏二极管是将光信号变成电信号的半导体器件，核心部分是一个PN结，PN结具有单向导电性，工作的时候需要加上反向电压，无光照时，有很小的饱和反向漏电流，此时光敏二极管截止。当收到光照时，饱和反向漏电流增加，形成光电流且随着光强增大而增大。")]),t._v(" "),s("p",[t._v("BH1750 基于光照强弱，改变电路中的电流，然后利用运算放大器将电流放大，再由模数装换器将模拟信号转换为数字信号，通过计算模块计算后放入芯片相应的寄存器里面，供其他主控通过 IIC 通信接口读取光强数据。")]),t._v(" "),t._m(16),t._v(" "),s("p",[t._v("BH1750的外围电路比较简单，除了ADR引脚接1K电阻接地，DVI接1K上拉之外就只需要接IIC两个引脚的上拉电阻了。")]),t._v(" "),s("p",[t._v("BH1750 代码配置")]),t._v(" "),s("p",[t._v("打开Hardware目录下的BH1750.C文件")]),t._v(" "),t._m(17),t._v(" "),s("p",[t._v("这里我们使用的是软件模拟IIC来驱动传感器，所以只需初始化对应的IO口即可")]),t._v(" "),t._m(18),t._v(" "),s("p",[t._v("再调用I2C_Start、I2C_SendByte、I2C_Stop等模拟IIC函数即可实现对传感器寄存器数据的读写，并读取光照强度数据。")]),t._v(" "),t._m(19),t._v(" "),t._m(20),t._v(" "),s("p",[t._v("打开nb-iot_demo目录下的nb-iot_demo.c文件")]),t._v(" "),t._m(21),t._v(" "),s("p",[t._v("可以看到这个demo涵盖了温湿度检测、智慧烟感、GPS定位、智慧路灯四个案例，并在nb-iot_demo.h文件中通过宏定义来开启不同的案例。")]),t._v(" "),t._m(22),t._v(" "),s("p",[t._v("在nb-iot_demo.c的126行左右的位置，通过调用Convert_BH1750() 函数实现对传感器数据的读取，并将数据存入 BH1750_send 结构体中用于后面通过 NB-IoT 模块发送数据。")]),t._v(" "),t._m(23),t._v(" "),t._m(24),t._v(" "),s("p",[t._v("在nb-iot_demo.c的179行左右的位置,通过调用club_nbiot_send函数将所要发送的传感器数据通过队列的形式发送到平台上。")]),t._v(" "),t._m(25),t._v(" "),s("p",[t._v("此处club_nbiot_send函数是将传感器数据以消息队列的方式发送的nbiot数据发送任务中，再通过nbiot数据发送任务将队列中的数据逐条发送出去，保证了数据的可靠性。")]),t._v(" "),t._m(26),t._v(" "),t._m(27),t._v(" "),t._m(28),t._v(" "),s("p",[t._v("打开nb-iot_demo目录下的nb-iot_cmd_ioctl.c文件")]),t._v(" "),t._m(29),t._v(" "),s("p",[t._v("nb_cmd_data_ioctl函数是通过AT框架程序注册的平台下发指令URC数据的回调函数，只需在此函数中完成对下发指令的处理工作即可。")]),t._v(" "),s("p",[t._v("在nb-iot_cmd_ioctl.c文件的134行处通过分析平台的下发指令实现对扩展板的Light灯的控制")]),t._v(" "),t._m(30),t._v(" "),t._m(31),t._v(" "),s("p",[t._v("打开nb-iot_demo目录下的nb-iot_demo.c文件")]),t._v(" "),t._m(32),t._v(" "),s("p",[t._v("修改nb-iot_demo.c文件的198行的平台设备对接IP及端口即可实现对NB-IoT模块的初始化配置，平台设备对接IP及端口以申请平台时收到的邮件为准")]),t._v(" "),s("p",[t._v("至此已完成智慧路灯的设备程序的开发，编译程序并保存即可。")]),t._v(" "),t._m(33),t._v(" "),t._m(34),t._v(" "),t._m(35),t._v(" "),t._m(36),t._v(" "),t._m(37),t._v(" "),t._m(38),t._v(" "),t._m(39),t._v(" "),t._m(40),t._v(" "),t._m(41),t._v(" "),t._m(42),t._v(" "),t._m(43),t._v(" "),t._m(44),t._v(" "),t._m(45),t._v(" "),t._m(46),t._v(" "),t._m(47),t._m(48),t._v(" "),t._m(49),t._m(50),t._v(" "),t._m(51),t._m(52),t._v(" "),t._m(53),t._m(54),t._v(" "),t._m(55),t._m(56),t._v(" "),t._m(57),t._m(58),t._v(" "),t._m(59),t._m(60),t._v(" "),t._m(61),t._m(62),t._v(" "),t._m(63),t._m(64),t._v(" "),t._m(65),t._m(66),t._v(" "),t._m(67),t._m(68),t._v(" "),t._m(69),t._m(70),t._v(" "),t._m(71),t._m(72),t._v(" "),t._m(73),t._m(74),t._v(" "),t._m(75),t._m(76),t._v(" "),t._m(77),t._m(78),t._v(" "),t._m(79),t._m(80),t._v(" "),t._m(81),t._m(82),t._v(" "),t._m(83),t._v(" "),t._m(84),t._v(" "),t._m(85),t._v(" "),t._m(86),t._v(" "),t._m(87),t._v(" "),t._m(88),t._v(" "),t._m(89),t._v(" "),t._m(90),t._v(" "),t._m(91),t._v(" "),s("p",[t._v("【注意】如果指令返回ERROR或+CME ERROR: 513，那么重启模块等30秒后再发即可。")]),t._v(" "),t._m(92),t._v(" "),t._m(93),t._v(" "),t._m(94),t._v(" "),t._m(95),t._v(" "),t._m(96),t._v(" "),t._m(97),t._v(" "),t._m(98),t._v(" "),t._m(99),t._v(" "),t._m(100),t._v(" "),t._m(101),t._v(" "),t._m(102),t._v(" "),t._m(103),t._v(" "),t._m(104),t._v(" "),t._m(105),t._v(" "),t._m(106),t._v(" "),t._m(107),t._v(" "),t._m(108),t._v(" "),s("p",[t._v("注意：P12跳线帽和烧写器的接线方式。")]),t._v(" "),t._m(109),t._v(" "),t._m(110),t._v(" "),t._m(111),t._v(" "),t._m(112),t._v(" "),t._m(113),t._v(" "),t._m(114),t._v(" "),s("p",[t._v("Step 1")]),t._v(" "),t._m(115),t._v(" "),t._m(116),t._v(" "),t._m(117),t._v(" "),t._m(118),t._v(" "),t._m(119),t._v(" "),s("p",[t._v("【注意】根据OceanConnect账号邮件的内容来填写。")]),t._v(" "),t._m(120)])},a,!1,null,null,null);r.options.__file="light.md";e.default=r.exports}}]);